ğŸ“¡ Wi-Fi Management System with Anomaly Detection
ğŸ“Œ Project Overview

This project implements a Wi-Fi Management and Monitoring System that captures real-time network traffic, identifies application-level activity, and detects abnormal user behavior using rule-based and machine-learning-ready anomaly detection techniques.

The system is designed for shared Wi-Fi environments such as colleges, hostels, and labs, where administrators need visibility into how the network is actually being used, not just who is connected.

ğŸ¯ Key Objectives

Capture real-time Wi-Fi traffic

Identify applications and websites being accessed

Store structured activity data in MongoDB

Detect abnormal usage patterns (misuse, spikes, abuse)

Enable automated enforcement (flagging / auto-ban logic)

Provide a strong foundation for ML-based anomaly detection

ğŸ§  System Architecture (High Level)
Packets
  â†“
tshark (capture)
  â†“
analyze_activity.py
  â†“
MongoDB (detections)
  â†“
anomaly_detector.py
  â†“
MongoDB (anomalies)

ğŸ—‚ï¸ Project Structure
Backend/Detection_Management/
â”‚
â”œâ”€â”€ capture.py                # Live packet capture using tshark
â”œâ”€â”€ auto_monitor.py           # Orchestrates capture + processing
â”œâ”€â”€ analyze_activity.py       # Extracts domain, app, category
â”œâ”€â”€ domain_map.py             # Maps domains to applications
â”œâ”€â”€ model.py                  # Category classification logic
â”œâ”€â”€ save_detections_batch.py  # Batch insert into MongoDB
â”œâ”€â”€ session_lookup.py         # IP â†’ roll_no mapping
â”œâ”€â”€ anomaly_detector.py       # Rule-based anomaly detection
â”œâ”€â”€ check_sessions.py         # Debug active sessions
â”œâ”€â”€ debug_capture.py          # Debug captured packets
â”œâ”€â”€ db_client.py              # MongoDB connection
â””â”€â”€ README.md

ğŸ› ï¸ Technologies Used

Python 3

tshark / Wireshark

MongoDB

PyMongo

Scikit-learn (for future ML extension)

Windows / PowerShell environment

ğŸ“Š Data Storage Design
studentapp.detections

Stores per-event activity:

{
  "roll_no": "101",
  "client_ip": "192.168.137.1",
  "domain": "www.youtube.com",
  "app_name": "YouTube",
  "category": "video",
  "timestamp": "UTC time"
}

studentapp.anomalies

Stores detected abnormal behavior:

{
  "roll_no": "101",
  "client_ip": "192.168.137.1",
  "type": "EXCESSIVE_APP_USAGE",
  "app_name": "YouTube",
  "count": 42,
  "window_minutes": 5,
  "window_start": "UTC time",
  "severity": "medium",
  "detected_by": "rule",
  "auto_ban": false,
  "timestamp": "UTC time"
}

ğŸš¨ Anomaly Detection Logic
Detection Window

5-minute sliding window

Per-user (roll_no) behavior analysis

Implemented Rules

Excessive App Usage

Same app used too frequently in a short window

Category Abuse

Video + Social traffic dominates total activity

Traffic Spike

Sudden surge compared to previous time window

Intelligent Filtering

System / carrier / VoWiFi traffic excluded

Background multicast traffic ignored

Only user-driven application activity analyzed

ğŸ”’ Auto-Ban Logic

If a user triggers multiple anomalies within 30 minutes

auto_ban flag is set in the anomalies collection

No direct blocking implemented (safe for academic use)

â–¶ï¸ How to Run the Project
1ï¸âƒ£ Start MongoDB
mongod

2ï¸âƒ£ Insert Active Session (for testing)
use studentapp
db.active_sessions.insertOne({
  roll_no: "101",
  client_ip: "192.168.137.1",
  status: "active",
  login_time: new Date()
})

3ï¸âƒ£ Start Monitoring
python auto_monitor.py

4ï¸âƒ£ Generate Network Traffic

Use YouTube / Instagram / browsing

5ï¸âƒ£ Run Anomaly Detection
python anomaly_detector.py

6ï¸âƒ£ Verify Output
db.anomalies.find().pretty()

ğŸ¤– Machine Learning Extension (Implemented / Planned)
Implemented

Rule-based anomaly detection (baseline)

ML-Ready

Isolation Forest (selected model)

Features derived from 5-minute aggregates

Unsupervised learning (no labeled data required)

Referenced Models (Survey)

Isolation Forest

Local Outlier Factor (LOF)

One-Class SVM

ğŸ”® Future Scope

Full Isolation Forest integration

Real-time anomaly detection

Dashboard visualization

Predictive traffic modeling

Temporal deep-learning models (LSTM, Autoencoders)

Integration with firewall / access control

ğŸ“ Academic Relevance

Strong capstone-level system

Explainable, non-black-box logic

Privacy-preserving (no payload inspection)

Suitable for AI / ML / Cybersecurity domains

ğŸ“Œ One-Line Summary

A real-time Wi-Fi monitoring system that identifies application-level usage and detects abnormal user behavior using rule-based and machine-learning-ready anomaly detection.