ğŸ“¡ Wi-Fi Management System with Real-Time Anomaly Detection & Blocking
ğŸ“Œ Project Overview

This project implements a real-time Wi-Fi monitoring and anomaly detection system designed for shared networks such as colleges, hostels, and labs.

The system captures live network traffic, identifies applications being used, detects abnormal user behavior using rule-based logic and machine learning, and blocks users in real time when suspicious activity is confirmed.

The design focuses on:

Explainability

Privacy (no payload inspection)

Real-time response

Academic and industry relevance

ğŸ¯ Objectives

Monitor live Wi-Fi traffic

Identify applications and traffic categories

Store structured activity data in MongoDB

Detect abnormal behavior using rules

Confirm anomalies using machine learning

Block users automatically in real time

Avoid false positives using safe decision logic

ğŸ§  High-Level System Flow
Live Network Traffic
        â†“
Packet Capture (tshark)
        â†“
App & Category Detection
        â†“
MongoDB (detections)
        â†“
Rule-Based Anomaly Detection
        â†“
ML Confirmation (Isolation Forest)
        â†“
Decision Engine
        â†“
Real-Time User Blocking

ğŸ—‚ï¸ Project Structure
Backend/Detection_Management/
â”‚
â”œâ”€â”€ capture.py                # Live packet capture (tshark)
â”œâ”€â”€ auto_monitor.py           # Real-time monitoring & decision loop
â”œâ”€â”€ analyze_activity.py       # Packet â†’ app & category mapping
â”œâ”€â”€ domain_map.py             # Domain â†’ application mapping
â”œâ”€â”€ model.py                  # Traffic category classification
â”œâ”€â”€ save_detections_batch.py  # MongoDB batch inserts
â”œâ”€â”€ session_lookup.py         # IP â†’ roll_no mapping
â”œâ”€â”€ anomaly_detector.py       # Rule-based anomaly detection
â”œâ”€â”€ realtime_ml.py            # Real-time ML (Isolation Forest)
â”œâ”€â”€ decision_engine.py        # Rule + ML decision logic
â”œâ”€â”€ block_user.py             # Real-time user blocking
â”œâ”€â”€ db_client.py              # MongoDB connection
â””â”€â”€ README.md

ğŸ› ï¸ Technologies Used

Python 3

tshark / Wireshark

MongoDB

PyMongo

Scikit-learn

NumPy

Windows / PowerShell

ğŸ“Š Database Design
studentapp.detections

Stores per-event user activity.

{
  "roll_no": "101",
  "client_ip": "192.168.137.1",
  "domain": "www.youtube.com",
  "app_name": "YouTube",
  "category": "video",
  "timestamp": "UTC time"
}

studentapp.anomalies

Stores detected anomalies (rule-based and ML).

{
  "roll_no": "101",
  "type": "EXCESSIVE_APP_USAGE",
  "detected_by": "rule",
  "severity": "medium",
  "timestamp": "UTC time"
}

studentapp.blocked_users

Stores real-time blocked users.

{
  "roll_no": "101",
  "reason": "Real-time anomaly detected (Rule + ML)",
  "blocked_at": "UTC time",
  "status": "blocked"
}

ğŸš¨ Anomaly Detection Logic
Rule-Based Detection

Excessive application usage

High video/social media dominance

Sudden traffic spikes

Rules provide fast and explainable detection.

Machine Learning (Isolation Forest)

Uses aggregated behavior features

Learns normal usage patterns

Flags unusual behavior automatically

Works without labeled data

ML is used as a confirmation layer, not alone.

ğŸ” Real-Time Blocking Logic

A user is blocked only when:

Rule-based anomaly detected
AND
ML model confirms abnormal behavior


This ensures:

High accuracy

Fewer false positives

Safe real-time enforcement

Blocking is implemented at the database level, making it safe for academic environments.

â–¶ï¸ How to Run the Project
1ï¸âƒ£ Start MongoDB
mongod

2ï¸âƒ£ Insert Active User Session (Testing)
use studentapp
db.active_sessions.insertOne({
  roll_no: "101",
  client_ip: "192.168.137.1",
  status: "active",
  login_time: new Date()
})

3ï¸âƒ£ Start Real-Time Monitoring
python auto_monitor.py

4ï¸âƒ£ Generate Traffic

YouTube

Instagram

Google search

5ï¸âƒ£ Verify Outputs
db.detections.find().pretty()
db.anomalies.find().pretty()
db.blocked_users.find().pretty()

âœ… Testing Summary
Component	Status
Packet capture	âœ… Working
App detection	âœ… Accurate
MongoDB storage	âœ… Verified
Rule detection	âœ… Triggered
ML confirmation	âœ… Working
Real-time blocking	âœ… Successful
ğŸ”® Future Scope

Firewall-level network blocking

Dashboard visualization

Long-term behavior profiling

Advanced ML models (Autoencoders, LSTM)

Automated unblock policies

Admin alert system

ğŸ“ Academic Significance

Real-time intelligent system

Explainable AI approach

Privacy-preserving design

Suitable for AI / ML / Cybersecurity projects

Strong capstone and viva-ready implementation

ğŸ“Œ One-Line Summary

A real-time Wi-Fi monitoring system that detects abnormal user behavior using rules and machine learning and blocks users automatically with high confidence.
